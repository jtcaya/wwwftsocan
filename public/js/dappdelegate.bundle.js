(()=>{"use strict";var e={268:(e,t,n)=>{n.d(t,{ET:()=>s,EZ:()=>a,Ni:()=>o,Ue:()=>i,d_:()=>l,zt:()=>r});const o={DistributionToDelegators:distributionAbi,VoterWhitelister:voterWhitelisterAbi,FtsoRewardManager:ftsoRewardAbi,WNat:wnatAbi,FlareRegistry:flareAbi};document.getElementById("SelectedNetwork");const a={sgbLogo:'<g id="layer1-3"><polygon points="124.29 316.35 0 538.51 101.68 508.22 124.29 316.35"></polygon><polygon points="259.45 315.45 135.35 299.46 119.98 431.6 300.07 320.69 259.45 315.45"></polygon><polygon points="195.58 206.32 233.21 158.92 40.08 0 133.09 285.06 195.58 206.32"></polygon><polygon points="363.82 188.11 343.46 245.8 383.66 282.19 363.82 188.11"></polygon><polygon points="263.6 221.16 263.6 221.16 238.46 166.78 215.95 195.14 139.88 290.97 265.69 307.18 305.76 312.35 263.6 221.16"></polygon><polygon points="357 180.39 273.62 221.37 312.7 305.92 357 180.39"></polygon></g>',flrLogo:'<g id="layer1-2" transform="matrix(1.7,0,0,1.7,-0,120)"><path inkscape:connector-curvature="0" d="M 1.54,44.88 C 1.54,44.88 0,44.043066 0,43.309998 0,29.293727 13.305791,-2.1604174e-7 44.83,-2.1604171e-7 c 7.083657,1e-14 178,0 178,0 0,0 1.54998,0.83699994604171 1.54,1.57000021604171 -0.28292,20.783154 -17.20265,43.31 -44.86,43.31 -7.19693,0 -177.97,0 -177.97,0 z" id="path5842" /><path inkscape:connector-curvature="0" d="M -2.8370967e-7,133.36 C -0.01006008,134.093 1.5399997,134.93 1.5399997,134.93 c 0,0 73.8666673,0 110.8000003,0 25.5862,0 44.57708,-22.52684 44.86,-43.309998 0.01,-0.733001 -1.54,-1.570002 -1.54,-1.570002 0,0 -96.641983,0 -110.78,0 -25.4532,0 -44.5947035,22.52208 -44.88000028370967,43.31 z" id="path5840" /><path d="M 45.068739,202.56174 A 22.648399,22.301296 0 0 1 22.42034,224.86303 22.648399,22.301296 0 0 1 -0.22805977,202.56174 22.648399,22.301296 0 0 1 22.42034,180.26044 a 22.648399,22.301296 0 0 1 22.648399,22.3013 z" id="path5799" /></g>',costonLogo:'<g id="layer1-2"><path id="path5139" d="M 110.76382,510.98934 C 70.863727,504.70145 37.406693,477.5049 25.686374,441.83158 21.84306,430.13361 19.836232,415.02432 21.826707,412.77241 c 1.424546,-1.61163 13.378995,-1.76178 115.549773,-1.45126 113.89386,0.34613 113.96658,0.34786 123.75346,2.93072 36.37734,9.60039 64.41727,34.6805 75.08928,67.16306 3.80582,11.58382 5.84887,26.80869 3.89427,29.02001 -1.37588,1.55658 -14.29072,1.74294 -112.48957,1.62329 -61.01439,-0.0744 -113.60143,-0.55536 -116.8601,-1.06889 z M 58.12374,360.57705 c -25.044789,-7.74036 -40.80884,-31.76562 -36.505138,-55.6358 5.200706,-28.84542 33.769366,-47.59015 63.581441,-41.71767 20.233567,3.98566 34.715427,16.60405 40.884757,35.62379 7.82371,24.12021 -6.46935,51.40502 -31.733007,60.57687 -9.9696,3.61941 -26.540903,4.14674 -36.228053,1.15281 z M 21.826707,211.65048 c -1.990475,-2.2519 0.0164,-17.36119 3.859667,-29.05914 10.672006,-32.48258 38.711933,-57.56269 75.089266,-67.16307 9.78689,-2.58285 9.8596,-2.58458 123.75348,-2.93073 102.17076,-0.31051 114.12522,-0.16035 115.54977,1.45129 1.99047,2.25188 -0.0165,17.36119 -3.85967,29.05914 -10.67201,32.48257 -38.71194,57.56268 -75.08928,67.16306 -9.78688,2.58287 -9.8596,2.58459 -123.75346,2.93073 -102.170778,0.3105 -114.125227,0.16037 -115.549773,-1.45128 z"/></g>'},r=(new MetaMaskSDK.MetaMaskSDK({dappMetadata:{name:"FTSO Canada Dapp",url:"https://ftsocan.com",base64Icon:"iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAApPXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZxpkh63ckX/YxVeAhIzloMxwjvw8n0uqkVJfPKLsMNkSGx2fzUhM++QyKI7"},logging:{sdk:!1},checkInstallationImmediately:!1,extensionOnly:!0}),window.ethereum);async function i(e,t,n){let a=new(new Web3(t).eth.Contract)(o.FlareRegistry,n);const r=await a.methods.getAllContracts().call(),i=(s=Object.values(r)[0],l=e,Object.keys(s).find((e=>s[e]===l)));var s,l;return r[1][i]}function s(e){document.getElementById("ConnectWalletText").innerText=e}function l(e){document.getElementById("TokenBalance").innerText=e}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=n(268),t={costonLogo:e.EZ.costonLogo,flrLogo:e.EZ.flrLogo,sgbLogo:e.EZ.sgbLogo,ercAbi:e.Ni.WNat,voterWhitelisterAbi:e.Ni.VoterWhitelister,distributionAbiLocal:e.Ni.DistributionToDelegators,ftsoRewardAbiLocal:e.Ni.FtsoRewardManager,wrapBool:!0,isRealValue:!1,isAmount2Active:!1,metamaskInstalled:!1};function o(e){let t=document.getElementById("Amount1"),n=document.getElementById("ClaimButton");Number(t.value.replace(/[^0-9]/g,""))<1||Number(t.value.replace(/^0-9]/g,""))>100?(n.style.backgroundColor="rgba(143, 143, 143, 0.8)",n.style.cursor="auto",document.getElementById("ClaimButtonText").innerText="Enter Amount",e.isRealValue=!1):50===Number(t.value.replace(/[^0-9]/g,""))||100===Number(t.value.replace(/[^0-9]/g,""))?(n.style.backgroundColor="rgba(253, 0, 15, 0.8)",n.style.cursor="pointer",e.isRealValue=!0,document.getElementById("ClaimButtonText").innerText="Delegate",r(e)):(n.style.backgroundColor="rgba(143, 143, 143, 0.8)",n.style.cursor="auto",document.getElementById("ClaimButtonText").innerText="Enter Amount",e.isRealValue=!1)}function a(e){let t=document.getElementById("Amount2"),n=document.getElementById("ClaimButton");Number(t.value.replace(/[^0-9]/g,""))<1||Number(t.value.replace(/[^0-9]/g,""))>100?(n.style.backgroundColor="rgba(143, 143, 143, 0.8)",n.style.cursor="auto",document.getElementById("ClaimButtonText").innerText="Enter Amount",e.isRealValue=!1,e.isAmount2Active=!1):50===Number(t.value.replace(/[^0-9]/g,""))||100===Number(t.value.replace(/[^0-9]/g,""))?(n.style.backgroundColor="rgba(253, 0, 15, 0.8)",n.style.cursor="pointer",e.isRealValue=!0,e.isAmount2Active=!0,document.getElementById("ClaimButtonText").innerText="Delegate",r(e)):(n.style.backgroundColor="rgba(143, 143, 143, 0.8)",n.style.cursor="auto",document.getElementById("ClaimButtonText").innerText="Enter Amount",e.isRealValue=!1,e.isAmount2Active=!1)}function r(e){let t=document.getElementById("ftso-1"),n=document.getElementById("ftso-2"),o=document.getElementById("Amount1"),a=document.getElementById("Amount2"),r=document.getElementById("ClaimButton");Number(o.value.replace(/[^0-9]/g,""))+Number(a.value.replace(/[^0-9]/g,""))>100||0===Number(t?.options[t.selectedIndex]?.getAttribute("data-ftso"))||0!==Number(a.value.replace(/[^0-9]/g,""))&&""!==a.value.replace(/[^0-9]/g,"")&&"0"===n?.options[n.selectedIndex]?.getAttribute("data-ftso")?(r.style.backgroundColor="rgba(143, 143, 143, 0.8)",r.style.cursor="auto",document.getElementById("ClaimButtonText").innerText="Enter Amount",e.isRealValue=!1,e.isAmount2Active=!1):(r.style.backgroundColor="rgba(253, 0, 15, 0.8)",r.style.cursor="pointer",e.isRealValue=!0,e.isAmount2Active=!0,document.getElementById("ClaimButtonText").innerText="Delegate")}function i(n){document.getElementById("ConnectWallet").addEventListener("click",(async()=>{!async function(t,n,o){let a=new Web3(t);try{const r=await(0,e.Ue)("WNat",t,n);let i=new a.eth.Contract(o.ercAbi,r);const s=await async function(t){var n=document.getElementById("Accounts").getAttribute("data-address");if("GET"===t){if(0===n.trim().length||null===n.trim()){const t=(await e.zt.request({method:"eth_accounts"}))[0].trim();return document.getElementById("Accounts").setAttribute("data-address",t),t}return n}if("SET"===t){const t=(await e.zt.request({method:"eth_accounts"}))[0].trim();return document.getElementById("Accounts").setAttribute("data-address",t),t}}("GET");(0,e.ET)(s);const l=await i.methods.balanceOf(s).call();(0,e.d_)(round(a.utils.fromWei(l,"ether")))}catch(e){}}(n.rpcUrl,n.flrAddr,t)})),document.getElementById("Amount1").addEventListener("input",(function(){o(t);var e=this.value;-1===e.search("%")&&(e+="%");var n=e.length-1;0===n?(this.value=e.substring(0,n),this.setSelectionRange(n,n)):(this.value=e.substring(0,n)+"%",this.setSelectionRange(n,n))})),document.getElementById("Amount2").addEventListener("input",(function(){a(t);var e=this.value;-1===e.search("%")&&(e+="%");var n=e.length-1;0===n?(this.value=e.substring(0,n),this.setSelectionRange(n,n)):(this.value=e.substring(0,n)+"%",this.setSelectionRange(n,n))})),document.getElementById("ClaimButton").addEventListener("click",(async()=>{if(!1===t.isRealValue)$.alert("Please enter valid value");else{let r=document.getElementById("Amount1"),i=document.getElementById("Amount2"),s=document.getElementById("ftso-1"),l=document.getElementById("ftso-2"),d=new Web3(n.rpcUrl);d.setProvider(e.zt);const c=r.value,u=i.value,m=c.replace(/[^0-9]/g,""),g=u.replace(/[^0-9]/g,""),p=100*Number(m),h=100*Number(g);var o=s?.options[s.selectedIndex]?.getAttribute("data-addr"),a=l?.options[l.selectedIndex]?.getAttribute("data-addr");try{const r=(0,e.Ue)("WNat",n.rpcUrl,n.flrAddr);let i=new d.eth.Contract(t.ercAbi,r);const s=(await e.zt.request({method:"eth_requestAccounts"}))[0],l={from:s,to:r,data:i.methods.undelegateAll().encodeABI()},c={from:s,to:r,data:i.methods.delegate(o,p).encodeABI()};if(showSpinner((async()=>{await e.zt.request({method:"eth_sendTransaction",params:[l]}).then((e=>showConfirm(e))).catch((e=>showFail()))})),showSpinner((async()=>{await e.zt.request({method:"eth_sendTransaction",params:[c]}).then((e=>showConfirm(e))).catch((e=>showFail()))})),t.isAmount2Active){const t={from:s,to:r,data:i.methods.delegate(a,h).encodeABI()};showSpinner((async()=>{await e.zt.request({method:"eth_sendTransaction",params:[t]}).then((e=>showConfirm(e))).catch((e=>showFail()))}))}}catch(e){}}}))}window.onload=async n=>{let r,s=document.getElementById("SelectedNetwork"),l=document.getElementById("ftso-1"),d=document.getElementById("ftso-2");await async function(t){return new Promise((n=>{setTimeout((async()=>{var o=document.getElementById("SelectedNetwork");for(const e in dappNetworks){var a=document.createElement("option");a.value=dappNetworks[e].id,a.text=dappNetworks[e].chainidentifier,a.setAttribute("data-chainidhex","0x"+dappNetworks[e].chainid.toString(16)),a.setAttribute("data-rpcurl",dappNetworks[e].rpcurl),a.setAttribute("data-registrycontract",dappNetworks[e].registrycontract),o.appendChild(a)}o.options[0].setAttribute("selected","selected"),o.options.selectedIndex=Number(o.options[0].value)-1,await e.zt.request({method:"eth_requestAccounts"}).then((async function(){e.zt?(t.metamaskInstalled=!0,async function(){return!!(await e.zt.request({method:"eth_accounts"})).length}().then((async function(){await e.zt.request({method:"eth_chainId"}).then((async function(e){var a;a=o.options[0].getAttribute("data-chainidhex");for(var r=0;r<o.options.length;r++)o.options[r].getAttribute("data-chainidhex")===e?(o.options[r].setAttribute("selected","selected"),o.options.selectedIndex=Number(o.options[r].value)-1,a=e):o.options[r].removeAttribute("selected");if(!0===t.metamaskInstalled)try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:a}]}).catch((e=>console.error(e)))}catch(e){if(console.log(e),4902===e.code)try{await ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:a,rpcUrls:[o.options[o.selectedIndex].getAttribute("data-rpcurl")],chainName:`${o.options[o.selectedIndex].innerText} Mainnet`,iconUrls:[`https://portal.flare.network/token-logos/${o.options[o.selectedIndex].innerText}.svg`],nativeCurrency:{name:`${o.options[o.selectedIndex].innerText}`,symbol:`${o.options[o.selectedIndex].innerText}`,decimals:18}}]})}catch(e){throw e}}n()}))}))):(t.metamaskInstalled=!1,downloadMetamask())}))}),200)}))}(t).then((async()=>{(async function(e,t,n,o,a,r){return new Promise((i=>{setTimeout((()=>{var s=document.getElementById("SelectedNetwork");e=s?.options[s.selectedIndex].getAttribute("data-rpcurl"),t=s?.options[s.selectedIndex].getAttribute("data-chainidhex"),n=s?.options[s.selectedIndex].value,r=s?.options[s.selectedIndex].getAttribute("data-registrycontract"),void 0===o&&void 0===a||(o=s?.options[s.selectedIndex].innerHTML,a="W"+o);var l={};l.selectedNetwork=s,l.rpcUrl=e,l.chainIdHex=t,l.networkValue=n,l.tokenIdentifier=o,l.wrappedTokenIdentifier=a,l.flrAddr=r,i(l)}),200)}))})(void 0,r,void 0).then((async n=>{i(n),document.getElementById("ConnectWallet").click(),await async function(n,o,a,r){return new Promise((i=>{setTimeout((async()=>{var s='<option value="" data-ftso="0" disabled selected hidden>Select FTSO</option>',l="",d="";let c=new Web3(a);try{const i=await(0,e.Ue)("VoterWhitelister",a,r);let u=new c.eth.Contract(t.voterWhitelisterAbi,i);const m=await u.methods.getFtsoWhitelistedPriceProviders("0").call(),g=JSON.stringify(m);fetch(dappUrlBaseAddr+"bifrost-wallet.providerlist.json").then((e=>e.json())).then((e=>{let t;e.providers.sort(((e,t)=>e.name>t.name?1:-1));for(var a=0;a<e.providers.length;a++)for(var r=0;r<m.length;r++)if(e.providers[a].address===m[r]){if(t=a,!g.includes(m[r])){$.alert("The FTSO you are delegated to is invalid!");break}"FTSOCAN"===e.providers[t].name?l+=`<option value="${r}" data-img="${dappUrlBaseAddr}assets/${m[r]}.png" data-addr="${m[r]}" data-ftso="1">${e.providers[t].name}</option>`:d+=`<option value="${r}" data-img="${dappUrlBaseAddr}assets/${m[r]}.png" data-addr="${m[r]}" data-ftso="1">${e.providers[t].name}</option>`,n.innerHTML=s+l+d,o.innerHTML=s+l+d}}))}catch(e){console.log(e)}i()}),200)}))}(l,d,n.rpcUrl,n.flrAddr),o(t),t.isAmount2Active&&a(t),l.onchange=async()=>{let e=l?.options[l.selectedIndex]?.getAttribute("data-img");document.getElementById("delegatedIcon1").src=e,o(t)},d.onchange=async()=>{let e=d?.options[d.selectedIndex]?.getAttribute("data-img");document.getElementById("delegatedIcon2").src=e,a(t)},s.onchange=async()=>{n.rpcUrl=s?.options[s.selectedIndex]?.getAttribute("data-rpcurl"),n.chainIdHex=s?.options[s.selectedIndex]?.getAttribute("data-chainidhex"),n.networkValue=s?.options[s.selectedIndex]?.value,o(t),t.isAmount2Active&&a(t);try{await e.zt.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]}),document.getElementById("ConnectWallet").click()}catch(e){}},"undefined"!=typeof accounts&&accounts!==[]&&window.ethereum.on("accountsChanged",(async t=>{if(0!==t.length){const n=t[0];(0,e.ET)(n)}else document.getElementById("ConnectWalletText").innerText="Connect Wallet",connectWalletBool=!1})),window.ethereum.on("chainChanged",(async t=>{for(var n=0;n<s?.options.length;n++)if(s?.options[n].getAttribute("data-chainidhex")===String(t)){s.options.selectedIndex=n,s.dispatchEvent(new Event("change"));break}if(!0===metamaskInstalled)try{await e.zt.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]})}catch(e){}}))}))}))}})()})();