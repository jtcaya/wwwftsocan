(()=>{"use strict";var e={268:(e,t,n)=>{n.d(t,{ET:()=>i,EZ:()=>d,IX:()=>m,NM:()=>c,Ni:()=>o,Ue:()=>l,d_:()=>u,zt:()=>s});const o={DistributionToDelegators:distributionAbi,VoterWhitelister:voterWhitelisterAbi,FtsoRewardManager:ftsoRewardAbi,WNat:wnatAbi,FlareRegistry:flareAbi};var a=document.getElementById("SelectedNetwork"),r=a?.options[a.selectedIndex].getAttribute("data-registrycontract");a?.options[a.selectedIndex].getAttribute("data-rpcurl"),a?.options[a.selectedIndex].getAttribute("data-chainidhex"),a?.options[a.selectedIndex].value,a?.options[a.selectedIndex].innerHTML;const d={sgbLogo:'<g id="layer1-3"><polygon points="124.29 316.35 0 538.51 101.68 508.22 124.29 316.35"></polygon><polygon points="259.45 315.45 135.35 299.46 119.98 431.6 300.07 320.69 259.45 315.45"></polygon><polygon points="195.58 206.32 233.21 158.92 40.08 0 133.09 285.06 195.58 206.32"></polygon><polygon points="363.82 188.11 343.46 245.8 383.66 282.19 363.82 188.11"></polygon><polygon points="263.6 221.16 263.6 221.16 238.46 166.78 215.95 195.14 139.88 290.97 265.69 307.18 305.76 312.35 263.6 221.16"></polygon><polygon points="357 180.39 273.62 221.37 312.7 305.92 357 180.39"></polygon></g>',flrLogo:'<g id="layer1-2" transform="matrix(1.7,0,0,1.7,-0,120)"><path inkscape:connector-curvature="0" d="M 1.54,44.88 C 1.54,44.88 0,44.043066 0,43.309998 0,29.293727 13.305791,-2.1604174e-7 44.83,-2.1604171e-7 c 7.083657,1e-14 178,0 178,0 0,0 1.54998,0.83699994604171 1.54,1.57000021604171 -0.28292,20.783154 -17.20265,43.31 -44.86,43.31 -7.19693,0 -177.97,0 -177.97,0 z" id="path5842" /><path inkscape:connector-curvature="0" d="M -2.8370967e-7,133.36 C -0.01006008,134.093 1.5399997,134.93 1.5399997,134.93 c 0,0 73.8666673,0 110.8000003,0 25.5862,0 44.57708,-22.52684 44.86,-43.309998 0.01,-0.733001 -1.54,-1.570002 -1.54,-1.570002 0,0 -96.641983,0 -110.78,0 -25.4532,0 -44.5947035,22.52208 -44.88000028370967,43.31 z" id="path5840" /><path d="M 45.068739,202.56174 A 22.648399,22.301296 0 0 1 22.42034,224.86303 22.648399,22.301296 0 0 1 -0.22805977,202.56174 22.648399,22.301296 0 0 1 22.42034,180.26044 a 22.648399,22.301296 0 0 1 22.648399,22.3013 z" id="path5799" /></g>',costonLogo:'<g id="layer1-2"><path id="path5139" d="M 110.76382,510.98934 C 70.863727,504.70145 37.406693,477.5049 25.686374,441.83158 21.84306,430.13361 19.836232,415.02432 21.826707,412.77241 c 1.424546,-1.61163 13.378995,-1.76178 115.549773,-1.45126 113.89386,0.34613 113.96658,0.34786 123.75346,2.93072 36.37734,9.60039 64.41727,34.6805 75.08928,67.16306 3.80582,11.58382 5.84887,26.80869 3.89427,29.02001 -1.37588,1.55658 -14.29072,1.74294 -112.48957,1.62329 -61.01439,-0.0744 -113.60143,-0.55536 -116.8601,-1.06889 z M 58.12374,360.57705 c -25.044789,-7.74036 -40.80884,-31.76562 -36.505138,-55.6358 5.200706,-28.84542 33.769366,-47.59015 63.581441,-41.71767 20.233567,3.98566 34.715427,16.60405 40.884757,35.62379 7.82371,24.12021 -6.46935,51.40502 -31.733007,60.57687 -9.9696,3.61941 -26.540903,4.14674 -36.228053,1.15281 z M 21.826707,211.65048 c -1.990475,-2.2519 0.0164,-17.36119 3.859667,-29.05914 10.672006,-32.48258 38.711933,-57.56269 75.089266,-67.16307 9.78689,-2.58285 9.8596,-2.58458 123.75348,-2.93073 102.17076,-0.31051 114.12522,-0.16035 115.54977,1.45129 1.99047,2.25188 -0.0165,17.36119 -3.85967,29.05914 -10.67201,32.48257 -38.71194,57.56268 -75.08928,67.16306 -9.78688,2.58287 -9.8596,2.58459 -123.75346,2.93073 -102.170778,0.3105 -114.125227,0.16037 -115.549773,-1.45128 z"/></g>'},s=window.ethereum;async function l(e){var t=document.getElementById("SelectedNetwork")?.options[document.getElementById("SelectedNetwork").selectedIndex].getAttribute("data-rpcurl");let n=new(new Web3(t).eth.Contract)(o.FlareRegistry,r);const a=await n.methods.getAllContracts().call(),d=(s=Object.values(a)[0],l=e,Object.keys(s).find((e=>s[e]===l)));var s,l;return a[1][d]}function c(e){return+(Math.round(e+"e+4")+"e-4")}function i(e){document.getElementById("ConnectWalletText").innerText=e}function u(e){document.getElementById("TokenBalance").innerText=e}function m(e){document.getElementById("ClaimButtonText").innerText=e}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e,t,o,a,r=n(268);async function d(){var e=document.getElementById("SelectedNetwork");let t=new Web3(e?.options[e.selectedIndex].getAttribute("data-rpcurl"));try{const e=await flareContract.methods.getAllContracts().call(),d=getKeyByValue(Object.values(e)[0],"WNat"),s=e[1][d],l=getKeyByValue(Object.values(e)[0],"DistributionToDelegators"),c=e[1][l],i=getKeyByValue(Object.values(e)[0],"FtsoRewardManager"),u=e[1][i],m=getKeyByValue(Object.values(e)[0],"VoterWhitelister"),w=e[1][m];let h=new t.eth.Contract(wnatAbi,s),g=new t.eth.Contract(distributionAbiLocal,c),p=new t.eth.Contract(ftsoRewardAbiLocal,u),y=new t.eth.Contract(voterWhitelisterAbi,w);const B=(await provider.send("eth_requestAccounts")).result[0];showAccountAddress(B),await t.eth.getBalance(B);const I=await h.methods.balanceOf(B).call();showTokenBalance(round(t.utils.fromWei(I,"ether"))),showFdRewards(0),showRewards(0),Number(document.getElementById("ClaimButtonText").innerText)>=1?switchButtonColor():switchButtonColorBack(),Number(document.getElementById("ClaimFdButtonText").innerText)>=1?switchButtonColor():switchButtonColorBack(),remove(".wrapBoxFTSO");const k=await y.methods.getFtsoWhitelistedPriceProviders(0).call(),N=JSON.stringify(k),b=await h.methods.delegatesOf(B).call(),f=b[0],v=b[1][0]/100n;let x="",C="";fetch(dappUrlBaseAddr+"bifrost-wallet.providerlist.json").then((e=>e.json())).then((e=>{var t;e.providers.sort(((e,t)=>e.name>t.name?1:-1));for(var n=0;n<e.providers.length;n++){t=n;for(var o=0;o<f.length;o++)e.providers[n].address===f[o]&&(N.includes(f[o])?("FTSOCAN"===e.providers[t].name?x=`<div class="wrapBoxFTSO" data-addr="${f[o]}"><div class="wrapBoxContent"><img src="${dappUrlBaseAddr}assets/${f[o]}.png" alt="${e.providers[t].name}" class="delegatedIcon" id="delegatedIcon"/><div class="ftsoIdentifier"><span id="delegatedName">${e.providers[t].name}</span></div><div class="Wrapper"><span id="TokenBalance">${v}%</span></div></div></div>`:C+=`<div class="wrapBoxFTSO" data-addr="${f[o]}"><div class="wrapBoxContent"><img src="${dappUrlBaseAddr}assets/${f[o]}.png" alt="${e.providers[t].name}" class="delegatedIcon" id="delegatedIcon"/><div class="ftsoIdentifier"><span id="delegatedName">${e.providers[t].name}</span></div><div class="Wrapper"><span id="TokenBalance">${v}%</span></div></div></div>`,delegatedFtsoElement.innerHTML=x+C):$.alert("The FTSO you have delegated to is invalid!"))}}));const T=await p.methods.getEpochsWithUnclaimedRewards(B).call();let E,A=0;for(var n=0;n<T.length;n++)E=await p.methods.getStateOfRewards(B,T[n]).call(),A+=Number(E[1]);const W=t.utils.fromWei(A,"ether");let M;const F=await g.methods.getClaimableMonths().call();for(var o=0;o<F.length;o++)M+=await g.methods.getClaimableAmountOf(B,Number(F[o])).call();var a=await t.eth.getBalance(u);Number(round(W))>=1&&Number(round(W))<a?(showRewards(round(W)),switchButtonColor()):switchButtonColorBack();var r=await t.eth.getBalance(c);Number(document.getElementById("ClaimFdButtonText").innerText)>=1&&Number(document.getElementById("ClaimFdButtonText").innerText)<r?(showFdRewards(String(round(t.utils.fromWei(M,"ether")))),switchFdButtonColor()):switchFdButtonColorBack()}catch(e){}}selectedNetwork;var s=r.EZ.costonLogo,l=r.EZ.flrLogo,c=r.EZ.sgbLogo,i=r.Ni.WNat,u=r.Ni.DistributionToDelegators,m=(r.Ni.VoterWhitelister,r.Ni.FtsoRewardManager),w=(document.getElementById("after"),document.getElementById("RewardsCheck")),h=!1,g=!1;function p(e){document.getElementById("wrappedTokenIdentifier").innerText=e}function y(){document.getElementById("ClaimButton").style.backgroundColor="rgba(143, 143, 143, 0.8)",h=!1,document.getElementById("ClaimButton").style.cursor="auto"}function B(){document.getElementById("ClaimFdButton").style.backgroundColor="rgba(143, 143, 143, 0.8)",g=!1,document.getElementById("ClaimFdButton").style.cursor="auto"}function I(e){document.getElementById("ClaimFdButtonText").innerText=e}document.getElementById("layer3").innerHTML=l,window.onload=e=>{!0===metamaskInstalled&&document.getElementById("ConnectWallet").addEventListener("click",d)},function(e){"1"===e?(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=l,p(a)):"2"===e?(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=c,p(a)):(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=s,p(a))}(t),p(a),selectedNetwork.onchange=async()=>{if(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),e=selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-chainidhex"),t=selectedNetwork?.options[selectedNetwork.selectedIndex].value,"1"===t?(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=l,p(a)):"2"===t?(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=c,p(a)):(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"),o=selectedNetwork?.options[selectedNetwork.selectedIndex].innerHTML,a="W"+o,document.getElementById("layer3").innerHTML=s,p(a)),!0===metamaskInstalled)try{await r.zt.request({method:"wallet_switchEthereumChain",params:[{chainId:e}]})}catch(e){}if(!1===connectWalletBool&&!0===metamaskInstalled){new Web3(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"));try{const e=isConnected();"false"!==await e?document.getElementById("ConnectWallet").click():$.alert("You are not connected!")}catch(e){}}},"undefined"!=typeof accounts&&accounts!==[]&&window.ethereum.on("accountsChanged",(async e=>{if(0!==e.length){let t=new Web3(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"));try{const n=await(0,r.Ue)("WNat");let o=new t.eth.Contract(i,n);const a=e[0];(0,r.ET)(a);const d=await o.methods.balanceOf(a).call();(0,r.d_)((0,r.NM)(t.utils.fromWei(d,"ether")))}catch(e){}}else document.getElementById("ConnectWalletText").innerText="Connect Wallet",(0,r.d_)(0),(0,r.IX)(0),I(0),y(),B(),connectWalletBool=!1})),window.ethereum.on("chainChanged",(async t=>{for(var n=0;n<selectedNetwork?.options.length;n++)if(selectedNetwork?.options[n].getAttribute("data-chainidhex")===String(t)){selectedNetwork.options.selectedIndex=n,selectedNetwork.dispatchEvent(new Event("change"));break}if(!0===metamaskInstalled)try{await r.zt.request({method:"wallet_switchEthereumChain",params:[{chainId:e}]})}catch(e){}})),!0===metamaskInstalled&&document.getElementById("ClaimButton").addEventListener("click",(async()=>{if(!0===h){let n=new Web3(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"));try{const o=(await r.zt.request({method:"eth_requestAccounts"}))[0],a=await(0,r.Ue)("WNat");let d=new n.eth.Contract(i,a);const s=await(0,r.Ue)("FtsoRewardManager");let l=new n.eth.Contract(m,s);const c=await l.methods.getEpochsWithUnclaimedRewards(o).call();for(var e,t=0;t<c.length;t++)e=w.checked?{from:o,to:s,data:l.methods.claim(o,o,String(c[t]),!0).encodeABI()}:{from:o,to:s,data:l.methods.claim(o,o,String(c[t]),!1).encodeABI()},showSpinner((async()=>{await r.zt.request({method:"eth_sendTransaction",params:[e]}).then((e=>showConfirm(e))).catch((e=>showFail()))}));const u=await d.methods.balanceOf(o).call();(0,r.IX)(0),y(),(0,r.d_)((0,r.NM)(n.utils.fromWei(u,"ether")))}catch(e){showFail()}}})),!0===metamaskInstalled&&document.getElementById("ClaimFdButton").addEventListener("click",(async()=>{if(!0===g){let t=new Web3(selectedNetwork?.options[selectedNetwork.selectedIndex].getAttribute("data-rpcurl"));try{const n=(await r.zt.request({method:"eth_requestAccounts"}))[0],o=await(0,r.Ue)("WNat");let a=new t.eth.Contract(i,o);const d=await(0,r.Ue)("DistributionToDelegators");let s=new t.eth.Contract(u,d);const l=await s.methods.getClaimableMonths().call();var e;for(const o in l)if(!o.includes("_")){e=w.checked?{from:n,to:d,data:s.methods.claim(n,n,l[o],!0).encodeABI()}:{from:n,to:d,data:s.methods.claim(n,n,l[o],!1).encodeABI()},showSpinner((async()=>{await r.zt.request({method:"eth_sendTransaction",params:[e]}).then((e=>showConfirm(e))).catch((e=>showFail()))})),I(0),B();const c=await a.methods.balanceOf(n).call();(0,r.d_)((0,r.NM)(t.utils.fromWei(c,"ether")))}}catch(e){}}}))})()})();